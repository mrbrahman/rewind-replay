!function(t){"use strict";function e(t,e,i){var s="#"+t+" {  position: relative;}."+e+"-figure {  background-color: #D5D5D5;  overflow: hidden;  left: 0;  position: absolute;  top: 0;  margin: 0;}."+e+"-figure img {  left: 0;  position: absolute;  top: 0;  height: 100%;  width: 100%;  opacity: 0;  transition: "+i/1e3+"s ease opacity;  -webkit-transition: "+i/1e3+"s ease opacity;}."+e+"-figure img."+e+"-thumbnail {  -webkit-filter: blur(30px);  filter: blur(30px);  left: auto;  position: relative;  width: auto;}."+e+"-figure img."+e+"-loaded {  opacity: 1;}",n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=s:a.appendChild(document.createTextNode(s)),n.appendChild(a)}function i(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}function s(t){var e=0;do isNaN(t.offsetTop)||(e+=t.offsetTop),t=t.offsetParent;while(t);return e}function n(t,s){return this.inRAF=!1,this.isTransitioning=!1,this.minAspectRatioRequiresTransition=!1,this.minAspectRatio=null,this.latestYOffset=0,this.lastWindowWidth=window.innerWidth,this.scrollDirection="down",this.visibleImages=[],this.settings={containerId:"pig",classPrefix:"pig",figureTagName:"figure",groupTagName:"group",groupHeadlineTagName:"groupheadline",enableGroupHeadline:!1,newRowPerGroup:!0,groupHeadlineHeight:48,getGroupHeadlineHTML:function(t){return"<h2>"+t+"</h2>"},spaceBetweenGroups:64,spaceBetweenImages:8,transitionSpeed:500,primaryImageBufferHeight:1e3,secondaryImageBufferHeight:300,thumbnailSize:20,urlForSize:function(t,e){return"/img/"+e+"/"+t},getMinAspectRatio:function(t){return t<=640?2:t<=1280?4:t<=1920?5:6},getImageSize:function(t){return t<=640?100:t<=1920?250:500}},i(this.settings,s||{}),this.container=document.getElementById(this.settings.containerId),this.container||console.error("Could not find element with ID "+this.settings.containerId),this.images=this._parseImageData(t),e(this.settings.containerId,this.settings.classPrefix,this.settings.transitionSpeed),this}function a(t,e,i){this.groupid=t,this.index=e,this.images=[],this.pig=i,this.classNames={group:i.settings.classPrefix+"-group",headline:i.settings.classPrefix+"group-headline"},this.existsOnPage=!1,i.settings.enableGroupHeadline&&this.createHeadline(),this.style={width:0,height:0,top:0,left:0}}function o(t,e,i,s){return this.existsOnPage=!1,this.aspectRatio=t.aspectRatio,this.filename=t.filename,this.index=e,this.pig=i,this.group=s,this.classNames={figure:i.settings.classPrefix+"-figure",thumbnail:i.settings.classPrefix+"-thumbnail",loaded:i.settings.classPrefix+"-loaded"},this}var h=function(){function t(){s||(s=!0,window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,66))}function e(){i.forEach(function(t){t()}),s=!1}var i=[],s=!1;return{add:function(e){i.length||window.addEventListener("resize",t),i.push(e)},disable:function(){window.removeEventListener("resize",t)},reEnable:function(){window.addEventListener("resize",t)}}}();n.prototype._getTransitionTimeout=function(){var t=1.5;return this.settings.transitionSpeed*t},n.prototype._getTransitionString=function(){return this.isTransitioning?this.settings.transitionSpeed/1e3+"s transform ease":"none"},n.prototype._recomputeMinAspectRatio=function(){var t=this.minAspectRatio;this.minAspectRatio=this.settings.getMinAspectRatio(this.lastWindowWidth),null!==t&&t!==this.minAspectRatio?this.minAspectRatioRequiresTransition=!0:this.minAspectRatioRequiresTransition=!1},n.prototype._parseImageData=function(t){var e=[];return t.forEach(function(t,i){var s=new a(t.groupid,i,this);t.images.forEach(function(t,e){var i=new o(t,e,this,s);s.addImage(i)}.bind(this)),e.push(s)}.bind(this)),e},n.prototype._computeLayout=function(){var t=parseInt(this.container.clientWidth),e=[],i=0,s=0,n=0;this._recomputeMinAspectRatio(),!this.isTransitioning&&this.minAspectRatioRequiresTransition&&(this.isTransitioning=!0,setTimeout(function(){this.isTransitioning=!1},this._getTransitionTimeout()));var a=this._getTransitionString(),o=[];[].forEach.call(this.images,function(h,r){var l=this,g=r+1<this.images.length?this.images[r+1].getAspectRatio():1e3;[].forEach.call(h.images,function(l,u){var p=this;n+=parseFloat(l.aspectRatio),e.push(l);var d=u+1===h.images.length,c=d&&r==this.images.length,m=this.settings.newRowPerGroup||n+g>=this.minAspectRatio||0!==s,f=c||d&&m;if(n>=this.minAspectRatio||f){var y=e.reduce(function(t,e){return t.indexOf(e.getGroupIndex())===-1&&t.push(e.getGroupIndex()),t},[]).length;n=Math.max(n,this.minAspectRatio);var w=t-this.settings.spaceBetweenImages*(e.length-1)-this.settings.spaceBetweenGroups*(y-1),I=w/n,x=e[0].getGroupIndex();e.forEach(function(t){var e=I*t.aspectRatio;x!==t.getGroupIndex()&&(i=0,x=t.getGroupIndex()),t.style={width:parseInt(e),height:parseInt(I),translateX:i,translateY:s,transition:a},i+=e+this.settings.spaceBetweenImages}.bind(p)),o.push(e),e=[],n=0,s+=parseInt(I)+this.settings.spaceBetweenImages,i=0}}.bind(l)),s=0}.bind(this));var h=0;o.forEach(function(t,e){var i=[],s=0,n=0,a=0,r=e+1===o.length,l=!1,g=this;t.forEach(function(e,o){var g=o+1===t.length+1;n=e.style.height+(r?0:this.settings.spaceBetweenImages),i.indexOf(e.getGroupIndex())===-1&&(a+=s+(0===s?0:this.settings.spaceBetweenGroups-this.settings.spaceBetweenImages),s=0,i.push(e.getGroupIndex()),e.getGroup().style.height+=n),s+=e.style.width+(g?0:this.settings.spaceBetweenImages),e.getGroup().style.width=Math.max(e.getGroup().style.width,s),e.getGroup().style.left=a,0===e.getGroup().style.top&&(this.settings.groupHeadlineHeight||e.getGroupIndex()>0)&&(l||(h+=this.settings.enableGroupHeadline?this.settings.groupHeadlineHeight:0,l=!0),e.getGroup().style.top=h)}.bind(g)),h+=n}.bind(this)),this.totalHeight=h-this.settings.spaceBetweenImages},n.prototype._doLayout=function(){this.container.style.height=this.totalHeight+"px";var t="up"===this.scrollDirection?this.settings.primaryImageBufferHeight:this.settings.secondaryImageBufferHeight,e="down"===this.scrollDirection?this.settings.secondaryImageBufferHeight:this.settings.primaryImageBufferHeight,i=s(this.container),n=window.innerHeight,a=this.latestYOffset-i-t,o=this.latestYOffset+n+e;this.images.forEach(function(t){t.updateVisibility(a,o)}.bind(this))},n.prototype._getOnScroll=function(){var t=this,e=function(){var e=window.pageYOffset;t.previousYOffset=t.latestYOffset||e,t.latestYOffset=e,t.scrollDirection=t.latestYOffset>t.previousYOffset?"down":"up",t.inRAF||(t.inRAF=!0,window.requestAnimationFrame(function(){t._doLayout(),t.inRAF=!1}))};return e},n.prototype.enable=function(){return this.onScroll=this._getOnScroll(),window.addEventListener("scroll",this.onScroll),this.onScroll(),this._computeLayout(),this._doLayout(),h.add(function(){this.lastWindowWidth=window.innerWidth,this._computeLayout(),this._doLayout()}.bind(this)),this},n.prototype.disable=function(){return window.removeEventListener("scroll",this.onScroll),h.disable(),this},a.prototype.addImage=function(t){this.images.push(t)},a.prototype.getAspectRatio=function(){var t=0;return this.images.forEach(function(e){t+=parseFloat(e.aspectRatio)}),t},a.prototype.getIndex=function(){return this.index},a.prototype.updateVisibility=function(t,e){var i=this.style.top,s=this.style.height+i;this.headline&&(i-=this.pig.settings.groupHeadlineHeight),i<=e&&s>=t?(this.load(),this.images.forEach(function(s){s.updateVisibility(t-i,e-i)})):this.hide()},a.prototype.getElement=function(){return this.element||(this.element=document.createElement(this.pig.settings.groupTagName),this.element.className=this.classNames.group,this.headline&&this.element.appendChild(this.headline),this._updateStyles()),this.element},a.prototype.createHeadline=function(){this.headline||(this.headline=document.createElement(this.pig.settings.groupHeadlineTagName),this.headline.className=this.classNames.headline)},a.prototype._updateStyles=function(){if(this.getElement().style.position="absolute",this.getElement().style.width=this.style.width+"px",this.getElement().style.height=this.style.height+"px",this.getElement().style.top=this.style.top+"px",this.getElement().style.left=this.style.left+"px",this.headline){var t=this.pig.settings.groupHeadlineHeight;this.headline.style.minWidth="100%",this.headline.style.height=t+"px",this.headline.style.top="-"+t+"px",this.headline.innerHTML=this.pig.settings.getGroupHeadlineHTML(this.groupid),this.headline.style.position="absolute"}},a.prototype.load=function(){this.existsOnPage||(this.pig.container.appendChild(this.getElement()),this._updateStyles()),this.existsOnPage=!0},a.prototype.hide=function(){this.existsOnPage&&this.pig.container.removeChild(this.getElement()),this.existsOnPage=!1},o.prototype.getGroupIndex=function(){return this.group.getIndex()},o.prototype.getGroup=function(){return this.group},o.prototype.updateVisibility=function(t,e){this.style.translateY<=e&&this.style.translateY+this.style.height>=t?this.load():this.hide()},o.prototype.load=function(){this.existsOnPage=!0,this._updateStyles(),this.group.getElement().appendChild(this.getElement()),setTimeout(function(){this.existsOnPage&&(this.thumbnail||(this.thumbnail=new Image,this.thumbnail.src=this.pig.settings.urlForSize(this.filename,this.pig.settings.thumbnailSize),this.thumbnail.className=this.classNames.thumbnail,this.thumbnail.onload=function(){this.thumbnail&&(this.thumbnail.className+=" "+this.classNames.loaded)}.bind(this),this.getElement().appendChild(this.thumbnail)),this.fullImage||(this.fullImage=new Image,this.fullImage.src=this.pig.settings.urlForSize(this.filename,this.pig.settings.getImageSize(this.pig.lastWindowWidth)),this.fullImage.onload=function(){this.fullImage&&(this.fullImage.className+=" "+this.classNames.loaded)}.bind(this),this.getElement().appendChild(this.fullImage)))}.bind(this),100)},o.prototype.hide=function(){this.getElement()&&(this.thumbnail&&(this.thumbnail.src="",this.getElement().removeChild(this.thumbnail),delete this.thumbnail),this.fullImage&&(this.fullImage.src="",this.getElement().removeChild(this.fullImage),delete this.fullImage)),this.existsOnPage&&this.group.getElement().removeChild(this.getElement()),this.existsOnPage=!1},o.prototype.getElement=function(){return this.element||(this.element=document.createElement(this.pig.settings.figureTagName),this.element.className=this.classNames.figure,this._updateStyles()),this.element},o.prototype._updateStyles=function(){this.getElement().style.transition=this.style.transition,this.getElement().style.width=this.style.width+"px",this.getElement().style.height=this.style.height+"px",this.getElement().style.transform="translate3d("+this.style.translateX+"px,"+this.style.translateY+"px, 0)"},"function"==typeof define&&define.amd?define(n):"undefined"!=typeof module&&module.exports?module.exports=n:t.Pig=n}(this);